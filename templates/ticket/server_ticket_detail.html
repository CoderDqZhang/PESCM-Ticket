{% extends "ticket/base_site.html" %}
{% block head %}
<style>
    .col-center-block {
        float: none;
        display: block;
        margin-top: 5%;
        margin-left: auto;
        margin-right: auto;
        background-color: white;
    }
</style>{% endblock %}
{% block content %}
<nav class="navbar navbar-expand-lg navbar-light bg-light navbar-fixed-top">
    <div class="collapse navbar-collapse" id="navbarSupportedContent">
        <ul class="navbar-nav mr-auto">
            <li class="nav-item">
                <a class="nav-link" href="{{rootUrl}}/api/ticket/create/">提交工单</a>
            </li>
            <li class="nav-item dropdown">
                <a class="nav-link dropdown-toggle" href="#" id="navbarDropdown" role="button" data-toggle="dropdown"
                   aria-haspopup="true" aria-expanded="false">
                    工单列表
                </a>
                <div class="dropdown-menu" aria-labelledby="navbarDropdown">
                    <a class="dropdown-item"
                       href="{{rootUrl}}/api/ticket/myticket/?page=1&status=4&dateType=100">我的工单</a>
                    <a class="dropdown-item" href="{{rootUrl}}/api/ticket/list/?page=1&status=4&dateType=100">工单列表</a>
                </div>
            </li>
            <li class="nav-item dropdown">
                <a class="nav-link dropdown-toggle" href="#" id="navbarTicket" role="button" data-toggle="dropdown"
                   aria-haspopup="true" aria-expanded="false">
                    工单设置
                </a>
                <div class="dropdown-menu" aria-labelledby="navbarDropdown">
                    <a class="dropdown-item" href="#">工单模型</a>
                </div>
            </li>
        </ul>
        <form class="form-inline my-2 my-lg-0" action="{{rootUrl}}/api/logout/">
        <span class="navbar-text" style="margin-right: 30px;">
      您好，{{ user.nickname }}
    </span>
            <button type="submit" class="btn btn-primary btn-sm">退出登录</button>
        </form>
    </div>
</nav>
<div class="bg-white border rounded d-block p-4 h-auto w-95 mt-4 ml-2 mr-2">
    <div class="flex-column d-flex bg-light justify-content-start">
        <div class="flex-row d-flex justify-content-start">
            <p class="font-weight-light">问题标题：</p>
            <p class="font-weight-bold">{{ticket.ticket_title}}</p>
        </div>
        <div class="flex-row d-flex justify-content-between">
            <div class="flex-row d-flex justify-content-start">
                <p class="font-weight-light">工单编号：</p>
                <p class="font-weight-bold">{{ticket.ticket_id}}</p>
            </div>
            <div class="flex-row d-flex justify-content-start">
                <p class="font-weight-light">创建时间：</p>
                <p class="font-weight-bold">{{ticket.create_time}}</p>
            </div>
            <div class="flex-row d-flex justify-content-start">
                <p class="font-weight-light">工单状态：</p>
                {% if ticket.ticket_status == 3 %}
                <p class="font-weight-bold text-success">完成</p>
                {% else %}
                <p class="font-weight-bold font-italic text-danger">未处理</p>
                {% endif %}
            </div>
        </div>
    </div>
</div>
<div class="bg-white border rounded d-block p-4 h-auto w-95 mt-4 ml-2 mr-2">
    <div class="flex-row d-flex justify-content-start">
        <p class="font-weight-bold">处理记录</p>
    </div>
    {% for confirm in confirms %}
    <div class="flex-column d-flex justify-content-start mt-1">
        <div class="flex-row d-flex justify-content-start">
            <p class="font-weight-light">处理人：</p>
            <p class="font-weight-bold">{{confirm.user}}</p>
        </div>
        {% if confirm.status == 1 %}
        <div class="flex-row d-flex justify-content-start">
            <p class="font-weight-light">内容：</p>
            <p class="font-weight-bold">{{confirm.content}}</p>
        </div>
        <div class="flex-row d-flex justify-content-start">
            <p class="font-weight-light">时间：</p>
            <p class="font-weight-bold">{{confirm.confirm_time}}</p>
        </div>
        {% endif %}
        <div class="flex-row d-flex justify-content-start">
            <p class="font-weight-light">状态：</p>
            {% if confirm.status == 1 %}
            <p class="font-weight-bold text-success">完成</p>
            {% else %}
            <p class="font-weight-bold font-italic text-danger">未处理</p>
            {% endif %}
        </div>
    </div>
    {% endfor %}
</div>
<div class="bg-white border rounded d-block p-4 h-auto w-95 mt-4 ml-2 mr-2">
    <form class="w-100" action="{{location.href}}" method="POST" id="ticketForm">

        <div class="form-group">
            <label for="exampleFormControlTextarea1">处理内容</label>
            <textarea class="form-control" id="exampleFormControlTextarea1" rows="3"
                      name="ticket_content" required></textarea>
        </div>

        <button type="submit" class="btn btn-primary">确定</button>
    </form>
</div>
{% endblock %}